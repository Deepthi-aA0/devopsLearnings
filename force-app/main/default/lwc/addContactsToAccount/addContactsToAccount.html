<template>
    <lightning-card title="Add Contacts to Account">

        <div>
            <lightning-button label="+ Add Contact" onclick={handleClick} variant="brand"></lightning-button>
        </div>

        <template if:true={showTable}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container" style="width: 60rem;height: 50.5rem;padding: 0;margin-top:10px;max-width:75rem;max-height:75rem">
                    <header class="slds-modal__header slds-modal__header_empty">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" 
                            title="Close" onclick={handleCloseUpload}>
                            <lightning-icon icon-name="utility:close" 
                                variant="inverse" 
                                size="small">
                            </lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h1 style="margin:6px">New Contact</h1>
                    </header>
        <!-- <div class="slds-p-around_medium"> -->
            <table class="slds-table slds-table_bordered">
                <thead>
                    <tr class="slds-line-height_reset">
                        <th scope="col" class="column-border">
                            <div class="slds-truncate" title="Add Contact">
                                <lightning-button-icon icon-name="utility:add" onclick={addRow}></lightning-button-icon>
                            </div>
                        </th>
                        <th scope="col" class="column-border">
                            <div class="slds-truncate" title="Account Name">Account Name</div>
                        </th>
                        <th scope="col" class="column-border">
                            <div class="slds-truncate" title="Contact Name">Contact Name</div>
                        </th>
                        <th scope="col" class="column-border">
                            <div class="slds-truncate" title="Contact Email">Contact Email</div>
                        </th>
                        <th scope="col" class="column-border">
                            <div class="slds-truncate" title="Contact Phone">Contact Phone</div>
                        </th>
                        <th scope="col" class="column-border">
                            <div class="slds-truncate" title="Delete">Delete</div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                        <template for:each={contacts} for:item="contact" for:index="index">
                            <tr key={contact.key}>
                                <td></td>
                                <td class="column-border">
                                    <lightning-record-edit-form object-api-name="Contact" onsuccess={handleSuccess}>
                                        <lightning-input-field field-name="AccountId" value={recordId} class="small-input" variant="label-hidden" ></lightning-input-field>
                                    </lightning-record-edit-form>
                                </td>
                                <td class="column-border">
                                    <lightning-record-edit-form object-api-name="Contact" onsuccess={handleSuccess}>
                                        <lightning-input-field field-name="LastName" class="small-input" key-field={contact.Id} data-record-id={contact.Id} variant="label-hidden" value={index.lastName} onchange={handleChange}></lightning-input-field>
                                    </lightning-record-edit-form>
                                </td>
                                <td class="column-border">
                                    <lightning-record-edit-form object-api-name="Contact" onsuccess={handleSuccess}>
                                        <lightning-input-field field-name="Email" class="small-input" variant="label-hidden" value={index.email} onchange={handleChange}></lightning-input-field>
                                    </lightning-record-edit-form>
                                </td>
                                <td class="column-border">
                                    <lightning-record-edit-form object-api-name="Contact" onsuccess={handleSuccess}>
                                        <lightning-input-field field-name="Phone" class="small-input" required="" variant="label-hidden" value={index.phone} onchange={handleChange}></lightning-input-field>
                                    </lightning-record-edit-form>
                                </td>
                                <td class="column-border">
                                    <lightning-button-icon icon-name="utility:delete" variant="bare" onclick={deleteRow} data-index={index}></lightning-button-icon>
                                </td>
                            </tr>
                        </template>
                </tbody>
            </table>            
            <footer class="slds-modal__footer slds-grid slds-grid_align-right">
                <div class="slds-col">
                    <lightning-button label="Cancel" onclick={handleCancel} class="slds-m-right_medium"></lightning-button>
                    <lightning-button label="Save" variant="brand" onclick={handleSave} class="slds-button slds-button_brand"></lightning-button>
                </div>
            </footer>
        <!-- </div> -->
        </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
        </template>


    </lightning-card>
</template>
